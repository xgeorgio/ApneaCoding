Title:<br/>
<b>SOSUS2H: Sonar array submarine finder - Spherical geodesics</b>

Description:<br/>
<p>This small demo illustrates how the Sound Surveillance System (SOSUS) sonar array network of the Cold War era worked in the software level. The passive sonars were installed at the bottom of the ocean floor listening in the deep sound channel (SOFAR), which exhibits exceptional sound propagation for thousands of km.

Despite the severe degradation of the sound signal due to absorption, diffusion and multipath effects, having three or (preferrably) more reference points of detection provides enough data for source finding via multi-lateration. The first detection serves mostly as a time-reset, i.e., initiation of the process, in order to measure accurate time differences of arrival (TDOA) in subsequent listening stations installed at known locations.

In this "realistic" version, spherical geodesics are assumed for Earth, which is not trivial to solve directly due to non-linear distance function (Haversine). Instead, a multi-variate version of the Newton-Raphson solver is implemented, involving the gradient matrix and a standard 2x2 linear system to solve. More specifically, the Jacobian is estimated with approximation of all the X-Y partial derivatives and the solution in each iteration provides the optimal adjustment (dx,dy) to the current solution. Additionally, a regularization factor has been added to this adjustment, in order to avoid extreme 'jumps' of the gradient and failure to converge, usually due to noisy or inaccurate measurements in the input data. Due to the very small linear system, a non-iterative solver is implemented via determinants for the Jacobian. This is not recommended for large linear systems, however in this case it is very straight-forward, very short in code and non-iterative structure enables more aggressive optimizations by the compiler.

Three listeting stations in northern Atlantic Ocean are defined in this example, namely at Nova Scotia, Bermuda and Norfolk. Two test cases are used for demonstration, one for the equi-distance location and one a pertubated location near it, in order to check the error in the solutions due to inaccurate (simulated) sensor measurements. The test data require precise estimation of the TDOA at the detection stations, which cannot be done accurately even with realistic-geodesic mapping tools like Google Earth. Hence, the predefined TDOA data are close but not precisely at the values that a real SOSUS detection would report. Additionally, a 1st-detection distance estimation is also an input, usually available indirectly via the time stretching due to multipath propagation effects in the raw signal (SOFAR channel).

This "realistic" version is for medium distances from the detectors (hundreds of km), since Haversine distance is very accurate for spherical geodesics and for the mean Earth radius. Additional accuracy can be achieved by Vincenty distance or similar (WGS84-compatible), which is a much more complex formulation than Haversive. However, the real accuracy of such sonar arrays at this precision (sub-km) is defined mostly by other factors, including water temperature, day/night, seasonal trends, ocean currents, salinity, etc.

Warning: In some older versions of Microsoft's Fortran 77, the batch process 'FORT.BAT' assumed that the input filename is given as argument *without* the '.FOR' extension. If it is given, then the output is unpredictable and usually results in a corrupted *original* (source) file! Make sure to always keep backup before compiling - I had to write the source code twice because of this.

DISCLAIMER: The current code is designed and implemented based entirely on publicly available material. No classified, commercial or patented sources were used whatsoever, any such similarily is purely coincidental and does not infringe the author in any way. For details see:
* "SOSUS" -- https://en.wikipedia.org/wiki/SOSUS
* "SOFAR channel" -- https://en.wikipedia.org/wiki/SOFAR_channel
* Solomon, Louis P. (April 2011). "Memoir of the Long Range Acoustic Propagation Program". U.S. Navy Journal of Underwater Acoustics. 61 (2): 176â€“205.
